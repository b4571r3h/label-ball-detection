<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TT Ball Admin Panel</title>
  <script defer src="static/main.js"></script>
  <style>
    :root { 
      --bg:#0f172a; --card:#111827; --muted:#94a3b8; --accent:#22d3ee; 
      --success:#10b981; --warning:#f59e0b; --danger:#ef4444;
    }
    body { 
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system; 
      background:var(--bg); color:#e5e7eb; 
    }
    .wrap { max-width:1400px; margin:24px auto; padding:0 16px; }
    .card { 
      background:var(--card); border:1px solid #1f2937; border-radius:14px; 
      padding:20px; margin-bottom:20px; 
    }
    .header { text-align:center; margin-bottom:32px; }
    .stats-grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(250px, 1fr)); gap:16px; }
    .stat-card { 
      background:#0b1220; border:1px solid #374151; border-radius:12px; 
      padding:20px; text-align:center; 
    }
    .stat-value { font-size:2.5rem; font-weight:bold; margin:8px 0; }
    .stat-label { color:var(--muted); font-size:14px; }
    
    .btn-group { display:flex; gap:8px; flex-wrap:wrap; margin-bottom:16px; }
    .btn { 
      background:#1f2937; border:1px solid #374151; padding:12px 18px; 
      border-radius:10px; color:#e5e7eb; cursor:pointer; text-decoration:none;
      font-size:14px; font-weight:500; transition:all 0.2s;
    }
    .btn:hover { background:#111827; transform:translateY(-1px); }
    .btn.primary { background:var(--accent); border-color:var(--accent); color:#000; }
    .btn.success { background:var(--success); border-color:var(--success); color:#000; }
    .btn.warning { background:var(--warning); border-color:var(--warning); color:#000; }
    .btn.danger { background:var(--danger); border-color:var(--danger); color:#000; }
    .btn:disabled { opacity:0.5; cursor:not-allowed; }
    
    .table-container { overflow-x:auto; }
    .table { width:100%; border-collapse:collapse; margin-top:16px; }
    .table th, .table td { padding:12px; text-align:left; border-bottom:1px solid #374151; }
    .table th { background:#0b1220; font-weight:600; color:var(--accent); }
    .table tr:hover { background:#0b1220; }
    
    .tag { 
      display:inline-block; padding:4px 8px; border-radius:6px; 
      font-size:12px; font-weight:500; margin:2px; 
    }
    .tag.success { background:var(--success); color:#000; }
    .tag.warning { background:var(--warning); color:#000; }
    .tag.danger { background:var(--danger); color:#fff; }
    .tag.muted { background:#374151; color:#d1d5db; }
    
    .loading { text-align:center; color:var(--muted); font-style:italic; }
    .error { color:var(--danger); background:#7f1d1d; padding:12px; border-radius:8px; }
    .success-msg { color:var(--success); background:#064e3b; padding:12px; border-radius:8px; }
    
    .size-badge { 
      background:#1e293b; color:var(--accent); padding:4px 8px; 
      border-radius:6px; font-size:12px; font-family:monospace; 
    }
    
    .progress-bar {
      width:100%; height:6px; background:#374151; border-radius:3px; 
      overflow:hidden; margin:8px 0;
    }
    .progress-fill { 
      height:100%; background:linear-gradient(90deg, var(--accent), var(--success)); 
      transition:width 0.3s ease; 
    }
    
    /* Modal */
    .modal-overlay {
      position:fixed; top:0; left:0; width:100%; height:100%; 
      background:rgba(15, 23, 42, 0.9); display:none; align-items:center; 
      justify-content:center; z-index:1000; backdrop-filter:blur(5px);
    }
    .modal-content {
      background:var(--card); border:1px solid #1f2937; border-radius:16px; 
      padding:32px; max-width:500px; width:90%; text-align:center;
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      .stats-grid { grid-template-columns:1fr; }
      .btn-group { flex-direction:column; }
      .btn { width:100%; }
      .table { font-size:14px; }
      .table th, .table td { padding:8px; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="header">
      <h1>üõ†Ô∏è TT Ball Admin Panel</h1>
      <p style="color:var(--muted);">Verwaltung f√ºr Ball Detection & Analysis Platform</p>
    </div>

    <!-- Dashboard Stats -->
    <div class="card">
      <h2>üìä Storage Dashboard</h2>
      <div class="stats-grid" id="statsGrid">
        <div class="loading">Lade Statistiken...</div>
      </div>
    </div>

    <!-- Labeler Tasks Management -->
    <div class="card">
      <div style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap;">
        <h2>üèì Labeler Tasks</h2>
        <div class="btn-group">
          <button class="btn" onclick="refreshLabelerTasks()">üîÑ Aktualisieren</button>
          <button class="btn warning" onclick="showCleanupModal()">üßπ Cleanup</button>
        </div>
      </div>
      <div class="table-container">
        <table class="table" id="labelerTable">
          <thead>
            <tr>
              <th>Task ID</th>
              <th>Erstellt</th>
              <th>Frames</th>
              <th>Labels</th>
              <th>Video</th>
              <th>Gr√∂√üe</th>
              <th>Aktionen</th>
            </tr>
          </thead>
          <tbody id="labelerTableBody">
            <tr><td colspan="7" class="loading">Lade Tasks...</td></tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Analyzer Results Management -->
    <div class="card">
      <div style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap;">
        <h2>üî• Analyzer Ergebnisse</h2>
        <div class="btn-group">
          <button class="btn" onclick="refreshAnalyzerAnalyses()">üîÑ Aktualisieren</button>
        </div>
      </div>
      <div class="table-container">
        <table class="table" id="analyzerTable">
          <thead>
            <tr>
              <th>Analysis ID</th>
              <th>Erstellt</th>
              <th>Dateien</th>
              <th>Gr√∂√üe</th>
              <th>Downloads</th>
              <th>Aktionen</th>
            </tr>
          </thead>
          <tbody id="analyzerTableBody">
            <tr><td colspan="6" class="loading">Lade Analysen...</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Cleanup Modal -->
  <div class="modal-overlay" id="cleanupModal">
    <div class="modal-content">
      <h3>üßπ Alte Dateien l√∂schen</h3>
      <p style="color:var(--muted); margin:16px 0;">
        L√∂scht alle Tasks und Analysen, die √§lter als die angegebene Anzahl Tage sind.
      </p>
      <div style="margin:20px 0;">
        <label>Alter (Tage):</label>
        <input type="number" id="cleanupDays" value="30" min="1" max="365" 
               style="margin-left:8px; padding:8px; border-radius:6px; background:#1f2937; 
                      border:1px solid #374151; color:#e5e7eb; width:80px;">
      </div>
      <div class="btn-group" style="justify-content:center;">
        <button class="btn" onclick="hideCleanupModal()">Abbrechen</button>
        <button class="btn danger" onclick="performCleanup()">üóëÔ∏è L√∂schen</button>
      </div>
    </div>
  </div>

  <!-- Status Messages -->
  <div id="statusContainer" style="position:fixed; top:20px; right:20px; z-index:1001;"></div>
</body>
</html>
